meta {
  name: List Business Source Adjustable Summaries
  type: http
  seq: 1
}

get {
  url: {{base_url}}/individuals/self-assessment/adjustable-summary/{{nino}}/{{taxYear}}
  auth: none
}

query {
  typeOfBusiness: 
  businessId: 
}

headers {
  Accept: application/vnd.hmrc.7.0+json
  Authorization: Bearer {{access_token}}
}

script:pre-request {
  // Add Gov-Test-Scenario header if set
  const scenario = bru.getVar('Gov-Test-Scenario');
  if (scenario && scenario.trim() !== '') {
    req.setHeader('Gov-Test-Scenario', scenario);
  }
}

tests {
  test("Should return success", function() {
    expect(res.status).to.be.oneOf([200, 201, 204]);
  });
}

docs {
  ## List Business Source Adjustable Summaries
  
  This endpoint allows the user to generate a list of Business Source Adjustable Summaries for a given tax year. A 
filter can be set to return the summaries for a single business or business type. The National Insurance number must
be provided.

### Test data
Scenario simulation using Gov-Test-Scenario headers is only available in the sandbox environment.  

| Tax Years        | Header Value (Gov-Test-Scenario) | Scenario                                                                                                                      |
|------------------|----------------------------------|-------------------------------------------------------------------------------------------------------------------------------|
| ALL              | N/A - DEFAULT                    | Simulate a successful response containing multiple business types.                                                            |
| ALL              | SELF_EMPLOYMENT                  | Simulate a successful response containing a self-employment business.                                                         |
| ALL              | UK_PROPERTY                      | Simulate a successful response containing a UK property business.                                                             |
| Before 2025-26   | UK_PROPERTY_FHL                  | Simulate a successful response containing UK FHL property businesses.                                                         |
| ALL              | FOREIGN_PROPERTY                 | Simulate a successful response containing a foreign property business.                                                        |
| Before 2025-26   | FOREIGN_PROPERTY_FHL             | Simulate a successful response containing EEA FHL foreign property businesses.                                               |
| ALL              | NOT_FOUND                        | Simulates the scenario where no data is found.                                                                                |
| ALL              | REQUEST_CANNOT_BE_FULFILLED      | Simulates the scenario where the request cannot be fulfilled for various reasons other than the ones triggering other errors. |
| ALL              | DYNAMIC                          | The following response values will change to correspond to the values submitted in the request:<br> • businessID<br> • typeOfBusiness<br> • accountingPeriod.startdate<br> • accountingPeriod.enddate<br> • taxYear<br> • requestedDatetime<br> • adjustedDatetime |
| ALL              | STATEFUL                         | Performs a stateful list.                                                                                                     |   

  
  API: Business Source Adjustable Summary
}
