meta {
  name: Amend a Loss Claim Type
  type: http
  seq: 10
}

post {
  url: {{base_url}}/individuals/losses/{{nino}}/loss-claims/{{claimId}}/tax-year/{{taxYearClaimedFor}}/change-type-of-claim
  body: json
  auth: none
}

headers {
  Accept: application/vnd.hmrc.6.0+json
  Content-Type: {{Content-Type}}
  Authorization: Bearer {{access_token}}
}

script:pre-request {
  // Add Gov-Test-Scenario header if set
  const scenario = bru.getVar('Gov-Test-Scenario');
  if (scenario && scenario.trim() !== '') {
    req.setHeader('Gov-Test-Scenario', scenario);
  }
}

tests {
  test("Should return success", function() {
    expect(res.status).to.be.oneOf([200, 201, 204]);
  });
}

docs {
  ## Amend a Loss Claim Type
  
  This endpoint enables you to change the type of claim for an existing loss claim type.
A National Insurance Number, tax year and Claim ID must be provided.

<strong>
  Note: carry-sideways-fhl type of loss claims for income sources uk-property-fhl and foreign-property-fhl-eea will not be supported from tax year 2025-26 onwards.
</strong>

### Test data
Scenario simulation using Gov-Test-Scenario headers is only available in the sandbox environment.

| Header Value (Gov-Test-Scenario) | Scenario                                                                                                                                               |
| -------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------ |
| N/A - DEFAULT                    | Simulates success response.                                                                                                                            |
| FP_FORWARD                       | Simulates a Foreign Property carried forward scenario.                                                                                                 |
| FP_SIDEWAYS                      | Simulates a Foreign Property carried sideways scenario.                                                                                                |
| UK_FORWARD                       | Simulates a UK Property (Non-FHL) carried forward scenario.                                                                                            |
| UK_FORWARD_TO_SIDEWAYS           | Simulates a UK Property (Non-FHL) carried forward to sideways scenario.                                                                                |
| UK_SIDEWAYS                      | Simulates a UK Property (Non-FHL) carried sideways scenario.                                                                                           |
| UK_SIDEWAYS_FHL                  | Simulates a UK Property FHL carried sideways scenario.                                                                                                 |
| SE_FORWARD                       | Simulates a Self Employment carried forward scenario.                                                                                                  |
| SE_SIDEWAYS                      | Simulates a Self Employment carried sideways scenario.                                                                                                 |
| NO_CHANGE                        | Simulates the scenario where the relief type has not changed.                                                                                          |
| TYPE_OF_CLAIM_INVALID            | Simulates the scenario where a claim type is invalid for the income source.                                                                            |         
| CSFHL_CLAIM_NOT_SUPPORTED        | Simulates the scenario where carry-sideways-fhl claim submitted for income sources "FHL Property - EEA" and "UK Property FHL".                         |
| NOT_FOUND                        | Simulates the scenario where no data is found.                                                                                                         |
| OUTSIDE_AMENDMENT_WINDOW         | Simulates the scenario where request cannot be completed as it is outside the amendment window.                                                        |
| STATEFUL                         | Performs a stateful update.                                                                                                                            |
| DYNAMIC                          | The following response values will change to correspond to the values submitted in the request:<br> • typeOfClaim<br> •  typeOfLoss<br> • lastModified |

  
  API: Individual Losses
}
