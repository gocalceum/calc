meta {
  name: List Brought Forward Losses
  type: http
  seq: 3
}

get {
  url: {{base_url}}/individuals/losses/{{nino}}/brought-forward-losses/tax-year/{{taxYearBroughtForwardFrom}}
  auth: none
}

query {
  businessId: 
  typeOfLoss: 
}

headers {
  Accept: application/vnd.hmrc.6.0+json
  Authorization: Bearer {{access_token}}
}

script:pre-request {
  // Add Gov-Test-Scenario header if set
  const scenario = bru.getVar('Gov-Test-Scenario');
  if (scenario && scenario.trim() !== '') {
    req.setHeader('Gov-Test-Scenario', scenario);
  }
}

tests {
  test("Should return success", function() {
    expect(res.status).to.be.oneOf([200, 201, 204]);
  });
}

docs {
  ## List Brought Forward Losses
  
  This endpoint enables you to retrieve a list of all brought forward losses that have incurred before joining MTD.
A National Insurance number and tax year must be provided.

<strong>
  Note: Brought forward losses for the following 2 income sources will not be supported from tax year 2025-26 onwards:
    <ul>
      <li>uk-property-fhl</li>
      <li>foreign-property-fhl-eea</li>
    </ul>
</strong>

### Test data
Scenario simulation using Gov-Test-Scenario headers is only available in the sandbox environment.

| Header Value (Gov-Test-Scenario) | Scenario                                                 |
|----------------------------------|----------------------------------------------------------|
| N/A - DEFAULT                    | Simulates success response with multiple business types. |
| SELF_EMPLOYMENT                  | Simulates success response with only self-employment.    |
| UK_PROPERTY                      | Simulates success response with only UK property.        |
| FOREIGN_PROPERTY                 | Simulates success response with only foreign property.   |
| TAX_YEAR_NOT_SUPPORTED           | Simulates the scenario where the tax year specified in taxYearBroughtForwardFrom is not supported. |
| NOT_FOUND                        | Simulates the scenario where no data is found.           |
| DYNAMIC                          | The following response values will change to correspond to the values submitted in the request:<br> • businessID<br> • typeOfLoss<br> • taxYearBroughtForwardFrom<br> • lastModified |
| STATEFUL                         | Performs a stateful list.                                |

  
  API: Individual Losses
}
